<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Using advanced props</title>
  <link rel="stylesheet" href="https://unpkg.com/style.css">
  <style type="text/css">
    .markdown-body {
      max-width: 46em;
      margin: 2em auto;
      padding: 0 1em;
      overflow: hidden;
      word-wrap: break-word;
    }
  </style>
</head>
<body>
  <main class="markdown-body"><link id="viewx-style-style-0" rel="stylesheet" type="text/css" href="https://unpkg.com/highlight.js@9.18.1/styles/darkula.css">
<hr>
<h3>JSONX Manual</h3>
<ul>
<li><a href="https://jsonx.anydata.app">Home</a></li>
<li><a href="../getting-started/index.html">Getting Started</a></li>
<li><a href="../using-external-and-custom-components/index.html">External and Custom Components</a></li>
<li><a href="../using-advanced-props/index.html">Using Advanced Props</a></li>
<li><a href="../creating-react-components-and-component-libraries/index.html">Creating React Components and Component Libraries</a></li>
<li><a href="../spec/index.html">JSONX &amp; JXM Spec</a></li>
<li><a href="../samples/index.html">Samples</a></li>
<li><a href="../roadmap/index.html">Roadmap</a></li>
<li><a href="../../index.html">Full API Docs</a></li>
</ul>
<hr>
<h1>Using advanced props</h1>
<p>JSONX is created so you can create react elements and components with only JSON. Advanced props allow for your components to interact with dynamic data for example:</p>
<ul>
<li>referencing stateful properties dynamically</li>
<li>formatting the output of props</li>
<li>inserting templates into your JXM Objects</li>
</ul>
<p>There are six kinds of Advanced Props:</p>
<ol>
<li>Traverse Props - used to traverse data passed into elements or other dynamic/stateful data and assign values as props</li>
<li>Evaluation Props - used to create function properties or component properties and assign values as props</li>
<li>Format Props - used to format children props for example converting number formats or formatting dates</li>
<li>Utility Props - used to preform functional tasks like inserting external JXM references (template support), or sharing props across components</li>
<li>Display Props - used to decide whether or not to render elements</li>
</ol>
<h2>Traverse Props</h2>
<p><em>(thisprops, thisstate, thiscontext, windowprops, resourceprops/asyncprops)</em></p>
<p>Traversed Props are used to assign props values from different objects. For example if you wanted to set the alt text of an image tag from the url of the window, because JXM objects are JSON it&#x2019;s impossible to get the dynamic value <code>window.location.href</code> and assign it to the alt prop.</p>
<pre><code class="hljs language-JavaScript"><span class="hljs-comment">//assume window.location.href = http://example.com</span>

<span class="hljs-keyword">const</span> JXM = {
  <span class="hljs-attr">component</span>:<span class="hljs-string">&apos;img&apos;</span>,
  <span class="hljs-attr">props</span>:{
    <span class="hljs-attr">src</span>:<span class="hljs-string">&apos;path/to/some/image&apos;</span>,
    <span class="hljs-attr">alt</span>: <span class="hljs-comment">// ??? http://example.com</span>
  }
};
</code></pre>
<p>This is where traverse props are useful, for accessing <code>window.location.href</code> you want to traverse the <code>window</code> property and assign the <code>href</code> property from <code>window.location</code> to the <code>JXM.props.alt</code> property.</p>
<p>Traversing the <code>window</code> object is possibly by using the <code>windowprops</code> traverse prop. The other traverse props are:</p>
<ul>
<li>thisprops - traverse properties on <code>this.props</code></li>
<li>thisstate - traverse properties on <code>this.state</code></li>
<li>thiscontext - traverse properties on <code>this</code></li>
<li>windowprops - traverse properties on <code>window</code></li>
<li>resourceprops - traverse asynchronous properties passed to components when using JSONX programmatically</li>
<li>asyncprops - an alias for <code>resourceprops</code></li>
</ul>
<p>To properly reference <code>window.location.href</code> the following JXM Object would work</p>
<pre><code class="hljs language-JavaScript"><span class="hljs-keyword">const</span> JXM = {
 <span class="hljs-attr">component</span>:<span class="hljs-string">&apos;img&apos;</span>,
 <span class="hljs-attr">props</span>:{
   <span class="hljs-attr">src</span>:<span class="hljs-string">&apos;path/to/some/image&apos;</span>,
 },
 <span class="hljs-attr">windowprops</span>:{
   <span class="hljs-attr">alt</span>:[<span class="hljs-string">&apos;location&apos;</span>,<span class="hljs-string">&apos;href]
 }
}
</span></code></pre>
<p>Traverse props assign properties to <code>JXM.props</code> object by defining what property you want to set on <code>JXM.props</code> as the traverse prop name and passing an array to the property value you want. So for a window&#x2019;s location (<code>window.location.href</code>) the property value is accessed by an array to the href <code>[&apos;location&apos;,&apos;href&apos;]</code> where you omit the transverse object from the array path.</p>
<p>Some sample use cases are:</p>
<ul>
<li>Resourceprops transverse an object that is manually passed (usually as a result of an asynchronous fetch all - hence the name asyncprops).</li>
<li>Thisprops transverses anything bound to <code>this.props</code>, a good example would be if you&#x2019;re storing and passing a user object on <code>this.props.username</code>, pulling the username would be where you would use thisprops.</li>
<li>Thisstate transverses anything bound to <code>this.state</code>, for example if you&#x2019;re updating the state of a component based on user input from a text field <code>this.state.value</code>, pulling the value would be where you would use thisstate.</li>
<li>Thiscontext transverses anything bound to <code>this</code>, a good example is if you&#x2019;re using JSONX programatically and you want to bind functionality to the render methods.</li>
<li>And like the previous example windowprops transverse anything on the global window object, like the current page location <code>window.location.href</code>.</li>
</ul>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// programmatic example</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> jsonx <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;jsonx&apos;</span>;

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>)</span>{

  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">&apos;/path/to/userdata&apos;</span>);
  <span class="hljs-keyword">const</span> asyncUserData = <span class="hljs-keyword">await</span> response.json();
  <span class="hljs-comment">/*
  asyncUserData = {
    user: {
      name: &apos;jsonx&apos;,
      description: &apos;react without javascript&apos;,
    },
    stats: {
      logins: 102,
      comments: 3,
    },
    authentication: &apos;OAuth2&apos;,
  };
  */</span>
  <span class="hljs-keyword">const</span> JXM = {
  <span class="hljs-attr">component</span>: <span class="hljs-string">&apos;div&apos;</span>,
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">id</span>: <span class="hljs-string">&apos;generatedJSONX&apos;</span>,
    <span class="hljs-attr">className</span>:<span class="hljs-string">&apos;jsonx&apos;</span>,
  },
  <span class="hljs-attr">resourceprops</span>:{
    <span class="hljs-attr">auth</span>: [ <span class="hljs-string">&apos;authentication&apos;</span>, ],
    <span class="hljs-attr">username</span>: [ <span class="hljs-string">&apos;user&apos;</span>, <span class="hljs-string">&apos;name&apos;</span>, ],
  },
  <span class="hljs-attr">children</span>: [
    {
      <span class="hljs-attr">component</span>: <span class="hljs-string">&apos;p&apos;</span>,
      <span class="hljs-attr">props</span>: {
        <span class="hljs-attr">style</span>: {
          <span class="hljs-attr">color</span>: <span class="hljs-string">&apos;red&apos;</span>,
          <span class="hljs-attr">fontWeight</span>:<span class="hljs-string">&apos;bold&apos;</span>,
        },
      },
      <span class="hljs-attr">asyncprops</span>:{
        <span class="hljs-attr">title</span>: [<span class="hljs-string">&apos;user&apos;</span>,<span class="hljs-string">&apos;description&apos;</span>]
      },
      <span class="hljs-attr">children</span>:<span class="hljs-string">&apos;hello world&apos;</span>,
    },
  ],
};

  <span class="hljs-comment">//render something silly</span>
  jsonx.jsonxRender(JXM,asyncUserData);
  <span class="hljs-comment">/*
  Renders this JXM Object:
  JXM = {
    component: &apos;div&apos;,
    props: {
      id: &apos;generatedJSONX&apos;,
      className:&apos;jsonx&apos;,
      auth: &apos;OAuth2&apos;,
      username: &apos;jsonx&apos;,
    },
    children: [
      {
        component: &apos;p&apos;,
        props: {
          style: {
            color: &apos;red&apos;,
            fontWeight:&apos;bold&apos;,
          },
          title:&apos;react without javascript&apos;,
        },
        children:&apos;hello world&apos;,
      },
    ],
  };
  */</span>
}

main();
</code></pre>
<h3>Example Traverse Props</h3>
<table style="border:0; width:100%">
  <tr>
    <td style="padding:0"><iframe width="100%" height="300" src="https://jsfiddle.net/yawetse/pz845dk9/4/embedded/js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
    </td>
    <td style="padding:0"><iframe width="100%" height="300" src="https://jsfiddle.net/yawetse/pz845dk9/4/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
    </td>
  </tr>
</table>
<hr>
<h2>Evaluation Props</h2>
<p><em>(_children, __dangerouslyEvalProps, __dangerouslyBindEvalProps, __dangerouslyEvalAllProps, __dangerouslyInsertComponents, __dangerouslyInsertReactComponents, __dangerouslyInsertJSONXComponents, __dangerouslyInsertFunctionComponents, __dangerouslyInsertClassComponents, __functionProps, __windowComponents , __windowComponentProps, __spreadComponent)</em></p>
<p>Evaluation Props are properties that are computed and resolve values onto the <code>JXM.props</code> property. They are helpful because in order to interact with dyanamic data and stateful information, they provide a way to describe declaratively how to assign properties onto the <code>JXM.props</code> property.</p>
<h3>_children</h3>
<p>The <code>_children</code> evaluation property is used to override the value of <code>JXM.children</code> and is usually only used when you want to dynamically set the value of the <code>children</code> property from an advanced property.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">//current URL: http://example.com</span>
<span class="hljs-keyword">const</span> JXMWindowLocation = {
  <span class="hljs-attr">component</span>:<span class="hljs-string">&apos;p&apos;</span>,
  <span class="hljs-attr">windowprops</span>:{
    <span class="hljs-attr">_children</span>:[<span class="hljs-string">&apos;location&apos;</span>,<span class="hljs-string">&apos;href&apos;</span>]
  }
};
<span class="hljs-comment">// computes: { component:&apos;p&apos;, children:&apos;http://example.com&apos;, }</span>
</code></pre>
<h3>__dangerouslyEvalProps, __dangerouslyBindEvalProps and __dangerouslyEvalAllProps</h3>
<p>The evaluation properties <code>__dangerouslyEvalProps</code>, <code>__dangerouslyBindEvalProps</code> and <code>__dangerouslyEvalAllProps</code> are properties used to evaluate strings and set the value the property value on a JXM Object.</p>
<p><code>__dangerouslyEvalAllProps</code> will evaluate a string as a function and assign the returned value of the function to the <code>props</code> property of a JXM object.
<em>Note: If passing the value as a string, remember this value has to be an expression, so either a <code>(({jsonx})=&gt;{})</code> or <code>(function({jsonx}){})</code>. There is one parameter passed into the function, it&#x2019;s the current value of the JXM Object on the jsonx property</em></p>
<p><code>__dangerouslyEvalProps</code> is used to evaluate the string value and assign it to the JXM.props value, the string must be a valid javascript expression <em>(Tip, if evaluting an object remember to wrap it ({some:&#x2018;obj&#x2019;, }) )</em>. If <code>__dangerouslyEvalProps</code> is a function, it will assign the value of the function called with one parameter <code>{jsonx}</code>.</p>
<p><code>__dangerouslyBindEvalProps</code> is used to assign functions to JXM object props values. This is usually for <em>onClick</em> and <em>onChange</em> functions. Each property of <code>__dangerouslyBindEvalProps</code> has to be a function, because it&#x2019;s attempts to assign the value as a function with <code>this</code> bound to it.</p>
<p>The reason why these functions exist are because there are instances where JSONX is delivered via JSON and JavaScript functions are not valid JSON values. This is typically used sparingly when JXM is sent server side. In practice there are many ways to pass functions as values (especially if they are bound to JSONX, then you can always reference functions by access properties off of <code>this</code> by using <code>thiscontext</code>).</p>
<h3>Example Evaluation Props</h3>
<table style="border:0; width:100%">
  <tr>
    <td style="padding:0"><iframe width="100%" height="300" src="https://jsfiddle.net/yawetse/n704z65x/7/embedded/js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
    </td>
    <td style="padding:0"><iframe width="100%" height="300" src="https://jsfiddle.net/yawetse/n704z65x/7/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
    </td>
  </tr>
</table>
<h3>__functionProps (legacy)</h3>
<p>The evaluation prop <code>__functionProps</code> is another way to assign a function value to a property in <code>JXM.props</code>. There are two ways of using <code>__functionProps</code>, one way for predefined functions and another way for dynamic functions.</p>
<h4>predefined functions</h4>
<p><code>__functionProps</code> can assign values from functions that exist on <code>this.props</code> (e.g. using something like react-router and accessing this.props.reduxRouter.push) or functions that exist on the <code>window</code> object.</p>
<p>Properties are assigned by using the value of the function by access the propery as a string, prefixed with &#x201C;func:&#x201D;. Function props merge onto jsonx.props after evaluating each functon string.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> JXM = {
  <span class="hljs-attr">component</span>:<span class="hljs-string">&apos;div&apos;</span>,
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">name</span>:<span class="hljs-string">&apos;test&apos;</span>,
  },
  <span class="hljs-attr">__functionProps</span>: {
    <span class="hljs-attr">onclick</span>:<span class="hljs-string">&apos;func:this.props.onClick&apos;</span>, <span class="hljs-comment">// if there&apos;s already a defined onClick Function</span>
    <span class="hljs-attr">printPage</span>: <span class="hljs-string">&apos;func:window.print&apos;</span>,
    <span class="hljs-attr">nav</span>:<span class="hljs-string">&apos;func:this.props.reduxRouter.push&apos;</span>,
  },
};
</code></pre>
<h4>inline functions</h4>
<p><code>__functionProps</code> can also generate functions from a string in a much less elegant way than using <code>__dangerouslyEvalProps</code>.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> thisProp = {
  <span class="hljs-attr">debug</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">window</span>: {
    <span class="hljs-attr">print</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">&apos;printed&apos;</span>,
    <span class="hljs-attr">localStorage</span>: {
      <span class="hljs-attr">getItem</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-string">&apos;gotItem&apos;</span>,
    },
  },
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">onClick</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-string">&apos;clicked&apos;</span>,
    <span class="hljs-attr">reduxRouter</span>: {
      <span class="hljs-attr">push</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-string">&apos;pushed&apos;</span>,
      <span class="hljs-attr">pop</span>:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-string">&apos;poped&apos;</span>,
    },
  },
};
<span class="hljs-keyword">const</span> jsonxTest = {
  <span class="hljs-attr">component</span>:<span class="hljs-string">&apos;div&apos;</span>,
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">name</span>:<span class="hljs-string">&apos;test&apos;</span>,
  },
  <span class="hljs-attr">__functionProps</span>: {
    <span class="hljs-attr">onclick</span>:<span class="hljs-string">&apos;func:this.props.onClick&apos;</span>,
    <span class="hljs-attr">printPage</span>: <span class="hljs-string">&apos;func:window.print&apos;</span>,
    <span class="hljs-attr">nav</span>:<span class="hljs-string">&apos;func:this.props.reduxRouter.push&apos;</span>,
  },
};
<span class="hljs-keyword">const</span> jsonxObj = getFunctionProps.call(thisProp, {
  <span class="hljs-attr">jsonx</span>: jsonxTest,
});
expect(jsonxObj).is.an(<span class="hljs-string">&apos;object&apos;</span>);
expect(<span class="hljs-built_in">Object</span>.keys(jsonxObj)).to.eql(<span class="hljs-built_in">Object</span>.keys(jsonxTest.__functionProps));
expect(jsonxObj.onclick()).to.eq(<span class="hljs-string">&apos;clicked&apos;</span>);
expect(jsonxObj.printPage()).to.eql(<span class="hljs-string">&apos;printed&apos;</span>);
expect(jsonxObj.nav()).to.eql(<span class="hljs-string">&apos;pushed&apos;</span>);
</code></pre>
<h5>comparisionprops</h5>
<p>Comparison props are used to contionally show components if they&#x2019;re truthy. They compare an array of left and right side values, if they are all true, the component is rendered. If <code>comparisonorprops:true</code> then only one condition needs to be true in order to render the component</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">//and conditions</span>
jsonx={
  <span class="hljs-attr">comparisonprops</span>: [{
    <span class="hljs-attr">left</span>: [<span class="hljs-string">&apos;bigNum&apos;</span>,],
    <span class="hljs-attr">operation</span>:<span class="hljs-string">&apos;lte&apos;</span>,
    <span class="hljs-attr">right</span>:[<span class="hljs-string">&apos;smallNum&apos;</span>,],
  },{
    <span class="hljs-attr">left</span>: [<span class="hljs-string">&apos;smallNum&apos;</span>,],
    <span class="hljs-attr">operation</span>:<span class="hljs-string">&apos;&lt;=&apos;</span>,
    <span class="hljs-attr">right</span>:[<span class="hljs-string">&apos;bigNum&apos;</span>,],
  }],
}
<span class="hljs-comment">//or conditions</span>
jsonx={
  <span class="hljs-attr">comparisonorprops</span>:<span class="hljs-literal">true</span>,
  <span class="hljs-attr">comparisonprops</span>: [{
    <span class="hljs-attr">left</span>: [<span class="hljs-string">&apos;truthy&apos;</span>,],
    <span class="hljs-attr">operation</span>:<span class="hljs-string">&apos;eq&apos;</span>,
    <span class="hljs-attr">right</span>:[<span class="hljs-string">&apos;falsey&apos;</span>,],
  },{
    <span class="hljs-attr">left</span>: [<span class="hljs-string">&apos;smallNum&apos;</span>,],
    <span class="hljs-attr">operation</span>:<span class="hljs-string">&apos;eq&apos;</span>,
    <span class="hljs-attr">right</span>:[<span class="hljs-string">&apos;smallNum&apos;</span>,],
  }],
}

<span class="hljs-comment">// All comparison operations</span>
<span class="hljs-keyword">switch</span> (opscompares.operation) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;eq&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;==&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left == opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;dneq&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;!=&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;!&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left !== opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;dnseq&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;!==&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left !== opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;seq&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;===&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left === opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;lt&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;&lt;&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left &lt; opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;lte&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;&lt;=&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left &lt;= opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;gt&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;&gt;&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left &gt; opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;gte&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;&gt;=&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left &gt;= opscompares.right;
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;dne&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;undefined&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;null&apos;</span>:
    <span class="hljs-keyword">return</span> opscompares.left === <span class="hljs-literal">undefined</span> || opscompares.left === <span class="hljs-literal">null</span>; 
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;!null&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;!undefined&apos;</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;exists&apos;</span>:
  <span class="hljs-keyword">default</span>:<span class="hljs-comment">//&apos;exists&apos;</span>
    <span class="hljs-keyword">return</span> opscompares.left !== <span class="hljs-literal">undefined</span> &amp;&amp; opscompares.left !== <span class="hljs-literal">null</span>;
}
</code></pre>
<hr>
<h3>JSONX Manual</h3>
<ul>
<li><a href="https://jsonx.anydata.app">Home</a></li>
<li><a href="../getting-started/index.html">Getting Started</a></li>
<li><a href="../using-external-and-custom-components/index.html">External and Custom Components</a></li>
<li><a href="../using-advanced-props/index.html">Using Advanced Props</a></li>
<li><a href="../creating-react-components-and-component-libraries/index.html">Creating React Components and Component Libraries</a></li>
<li><a href="../spec/index.html">JSONX &amp; JXM Spec</a></li>
<li><a href="../samples/index.html">Samples</a></li>
<li><a href="../roadmap/index.html">Roadmap</a></li>
<li><a href="../../index.html">Full API Docs</a></li>
</ul>
</main>
</body>
</html>

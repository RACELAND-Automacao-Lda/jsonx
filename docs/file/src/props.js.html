<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/props.js | JSONX</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="//www.googletagmanager.com/gtag/js?id=UA-112697260-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-112697260-2');
  </script><meta name="description" content="React JSON Syntax - Construct React elements, JSX and HTML with JSON without transpilers. JSONX supports React Function and Class Components, React Lazy and Suspense Components, and full support for React Hooks."><meta property="og:type" content="website"><meta property="og:url" content="https://repetere.github.io/jsonx"><meta property="og:site_name" content="JSONX"><meta property="og:title" content="JSONX"><meta property="og:image" content="https://jsonx.io/favicon.png"><meta property="og:description" content="React JSON Syntax - Construct React elements, JSX and HTML with JSON without transpilers. JSONX supports React Function and Class Components, React Lazy and Suspense Components, and full support for React Hooks."><meta property="og:author" content="https://github.com/repetere"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="JSONX"><meta property="twitter:description" content="React JSON Syntax - Construct React elements, JSX and HTML with JSON without transpilers. JSONX supports React Function and Class Components, React Lazy and Suspense Components, and full support for React Hooks."><meta property="twitter:image" content="https://jsonx.io/favicon.png"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/repetere/jsonx"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChildrenProperty">getChildrenProperty</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChildrenProps">getChildrenProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getJSONXChildren">getJSONXChildren</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DynamicComponent">DynamicComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getBoundedComponents">getBoundedComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComponentFromLibrary">getComponentFromLibrary</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComponentFromMap">getComponentFromMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFunctionFromEval">getFunctionFromEval</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactClassComponent">getReactClassComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactContext">getReactContext</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactFunctionComponent">getReactFunctionComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-__express">__express</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-__getReact">__getReact</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-__getReactDOM">__getReactDOM</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-__getUseGlobalHook">__getUseGlobalHook</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-compile">compile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactElementFromJSON">getReactElementFromJSON</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactElementFromJSONX">getReactElementFromJSONX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-jsonToJSX">jsonToJSX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-jsonxRender">jsonxRender</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-outputHTML">outputHTML</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-outputJSON">outputJSON</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-outputJSX">outputJSX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-boundArgsReducer">boundArgsReducer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getChildrenComponents">getChildrenComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComponentProps">getComponentProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getComputedProps">getComputedProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getEvalProps">getEvalProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFunctionFromProps">getFunctionFromProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getFunctionProps">getFunctionProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getJSONXProps">getJSONXProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getParamNames">getParamNames</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactComponentProps">getReactComponentProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getReactComponents">getReactComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getWindowComponents">getWindowComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-displayComponent">displayComponent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-fetchJSON">fetchJSON</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getAdvancedBinding">getAdvancedBinding</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getSimplifiedJSONX">getSimplifiedJSONX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-simpleJSONXSyntax">simpleJSONXSyntax</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-traverse">traverse</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validSimpleJSONXSyntax">validSimpleJSONXSyntax</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validateJSONX">validateJSONX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-advancedBinding">advancedBinding</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-componentMap">componentMap</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_jsonxChildren">_jsonxChildren</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_jsonxComponents">_jsonxComponents</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_jsonxProps">_jsonxProps</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-_jsonxUtils">_jsonxUtils</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getReactElement">getReactElement</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getRenderedJSON">getRenderedJSON</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jsonxHTMLString">jsonxHTMLString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-renderIndex">renderIndex</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ARGUMENT_NAMES">ARGUMENT_NAMES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STRIP_COMMENTS">STRIP_COMMENTS</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/props.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React from &apos;react&apos;;
import { getRenderedJSON, } from &apos;./main&apos;;
import * as utilities from &apos;./utils&apos;;
import { getComponentFromMap, getReactFunctionComponent, getReactContext, } from &apos;./components&apos;;
// if (typeof window === &apos;undefined&apos;) {
//   var window = window || {};
// }

//https://stackoverflow.com/questions/1007981/how-to-get-function-parameter-names-values-dynamically
export const STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;
export const ARGUMENT_NAMES = /([^\s,]+)/g;
/**
 * returns the names of parameters from a function declaration
 * @example
 * const arrowFunctionAdd = (a,b)=&gt;a+b;
 * function regularFunctionAdd(c,d){return c+d;}
 * getParamNames(arrowFunctionAdd) // =&gt; [&apos;a&apos;,&apos;b&apos;]
 * getParamNames(regularFunctionAdd) // =&gt; [&apos;c&apos;,&apos;d&apos;]
 * @param {Function} func 
 * @todo write tests
 */
export function getParamNames(func) {
  var fnStr = func.toString().replace(STRIP_COMMENTS, &apos;&apos;);
  var result = fnStr.slice(fnStr.indexOf(&apos;(&apos;)+1, fnStr.indexOf(&apos;)&apos;)).match(ARGUMENT_NAMES);
  if(result === null){
    result = [];
  }
  return result;
}

/**
 * It uses traverse on a traverseObject to returns a resolved object on propName. So if you&apos;re making an ajax call and want to pass properties into a component, you can assign them using asyncprops and reference object properties by an array of property paths
 * @param {Object} [traverseObject={}] - the object that contains values of propName
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @param {Object} [options.propName=&apos;asyncprops&apos;] - Property on JSONX to resolve values onto, i.e (asyncprops,thisprops,windowprops) 
 * @returns {Object} resolved object
 * @example
 const traverseObject = {
  user: {
    name: &apos;jsonx&apos;,
    description: &apos;react withouth javascript&apos;,
  },
  stats: {
    logins: 102,
    comments: 3,
  },
  authentication: &apos;OAuth2&apos;,
};
const testJSONX = {
  component: &apos;div&apos;,
  props: {
    id: &apos;generatedJSONX&apos;,
    className:&apos;jsonx&apos;,
  },
  asyncprops:{
    auth: [ &apos;authentication&apos;, ],
    username: [ &apos;user&apos;, &apos;name&apos;, ],
  },
  children: [
    {
      component: &apos;p&apos;,
      props: {
        style: {
          color: &apos;red&apos;,
          fontWeight:&apos;bold&apos;,
        },
      },
      children:&apos;hello world&apos;,
    },
  ],
};
const JSONXP = getJSONXProps({ jsonx: testJSONX, traverseObject, });
// =&gt; {
//   auth: &apos;OAuth2&apos;,
//   username: &apos;jsonx&apos;
// }

//finally resolves:
const testJSONX = {
  component: &apos;div&apos;,
  props: {
    id: &apos;generatedJSONX&apos;,
    className:&apos;jsonx&apos;,
    auth: &apos;OAuth2&apos;,
    username: &apos;jsonx&apos;,
  },
  children: [
    {
      component: &apos;p&apos;,
      props: {
        style: {
          color: &apos;red&apos;,
          fontWeight:&apos;bold&apos;,
        },
      },
      children:&apos;hello world&apos;,
    },
  ],
};
 */
export function getJSONXProps(options = {}) {
  // eslint-disable-next-line
  let { jsonx = {}, propName = &apos;asyncprops&apos;, traverseObject = {}, } = options;
  // return (jsonx.asyncprops &amp;&amp; typeof jsonx.asyncprops === &apos;object&apos;)
  // ? utilities.traverse(jsonx.asyncprops, resources)
  // : {};
  return (jsonx[ propName ] &amp;&amp; typeof jsonx[ propName ] === &apos;object&apos;)
    ? utilities.traverse(jsonx[ propName ], traverseObject)
    : {};
}

/**
 * returns children jsonx components defined on __spreadComponent spread over an array on props.__spread
 * @param {*} options 
 */
export function getChildrenComponents(options = {}) {
  const { allProps = {}, jsonx = {}, } = options;
  // const asyncprops = getJSONXProps({ jsonx, propName: &apos;spreadprops&apos;, traverseObject: allProps, });
  if (Array.isArray(allProps.__spread) === false) {
    if ((this &amp;&amp; this.debug) || jsonx.debug) {
      return {
        children: new Error(&apos;Using __spreadComponent requires an array prop \&apos;__spread\&apos;&apos;).toString(),
      };
    } else {
      return { children:undefined, };
    }
  } else {
    return {
      _children: allProps.__spread.map(__item =&gt; {
        const clonedChild = Object.assign({}, jsonx.__spreadComponent);
        const clonedChildProps = Object.assign({}, clonedChild.props);
        clonedChildProps.__item = __item;
        clonedChild.props = clonedChildProps;
        return clonedChild;
      }),
    };
  }
}

export function boundArgsReducer(jsonx = {}) {
  return (args, arg) =&gt; {
    let val;
    if (this &amp;&amp; this.state &amp;&amp; typeof this.state[ arg ] !== &apos;undefined&apos;) val = (this.state[ arg ]);
    else if (this &amp;&amp; this.props &amp;&amp; typeof this.props[ arg ] !== &apos;undefined&apos;) val = (this.props[ arg ]);
    else if (jsonx.props &amp;&amp; typeof jsonx.props[ arg ] !== &apos;undefined&apos;) val = (jsonx.props[ arg ]);
    if (typeof val !== &apos;undefined&apos;) args.push(val);
    return args.filter(a=&gt;typeof a!==&apos;undefined&apos;);
  };
}

/**
 * Used to evalute javascript and set those variables as props. getEvalProps evaluates __dangerouslyEvalProps and __dangerouslyBindEvalProps properties with eval, this is used when component properties are functions, __dangerouslyBindEvalProps is used when those functions require that this is bound to the function. For __dangerouslyBindEvalProps it must resolve an expression, so functions should be wrapped in (). I.e. (function f(x){ return this.minimum+x;})
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @returns {Object} returns resolved object with evaluated javascript
 * @example
 const testVals = {
    auth: &apos;true&apos;,
    username: &apos;(user={})=&gt;user.name&apos;,
  };
  const testJSONX = Object.assign({}, sampleJSONX, {
    __dangerouslyEvalProps: testVals, __dangerouslyBindEvalProps: {
      email: &apos;(function getUser(user={}){ return this.testBound(); })&apos;,
    },
  });
  const JSONXP = getEvalProps.call({ testBound: () =&gt; &apos;bounded&apos;, }, { jsonx: testJSONX, });
  const evalutedComputedFunc = JSONXP.username({ name: &apos;bob&apos;, });
  const evalutedComputedBoundFunc = JSONXP.email({ email:&apos;test@email.domain&apos;, });
  // expect(JSONXP.auth).to.be.true;
  // expect(evalutedComputedFunc).to.eql(&apos;bob&apos;);
  // expect(evalutedComputedBoundFunc).to.eql(&apos;bounded&apos;);
 */
export function getEvalProps(options = {}) {
  const { jsonx, } = options;
  const scopedEval = eval; //https://github.com/rollup/rollup/wiki/Troubleshooting#avoiding-eval
  let evAllProps = {};
  if (jsonx.__dangerouslyEvalAllProps) {
    let evVal;
    try {
      // eslint-disable-next-line
      evVal = (typeof evVal === &apos;function&apos;)
        ? jsonx.__dangerouslyEvalAllProps
        : scopedEval(jsonx.__dangerouslyEvalAllProps);
    } catch (e) { 
      if (this.debug || jsonx.debug) evVal = e;
    }
    evAllProps = evVal.call(this, { jsonx, });
  }
  const evProps = Object.keys(jsonx.__dangerouslyEvalProps || {}).reduce((eprops, epropName) =&gt; {
    let evVal;
    let evValString;
    try {
      // eslint-disable-next-line
      evVal = scopedEval(jsonx.__dangerouslyEvalProps[ epropName ]);
      evValString = evVal.toString();
    } catch (e) { 
      if (this.debug || jsonx.debug) evVal = e;
    }
    eprops[ epropName ] = (typeof evVal === &apos;function&apos;)
      ? evVal.call(this, { jsonx, })
      : evVal;
    if (this.exposeEval) eprops[ `__eval_${epropName}` ] = evValString;
    return eprops;
  }, {});
  const evBindProps = Object.keys(jsonx.__dangerouslyBindEvalProps || {}).reduce((eprops, epropName) =&gt; {
    let evVal;
    let evValString;

    try {
      let args;
      const functionBody = jsonx.__dangerouslyBindEvalProps[ epropName ];
      // InlineFunction = Function.prototype.constructor.apply({}, args);
      let functionDefinition;
      if (typeof functionBody === &apos;function&apos;) {
        functionDefinition = functionBody;
      } else {
        functionDefinition = scopedEval(jsonx.__dangerouslyBindEvalProps[ epropName ]);
        evValString = functionDefinition.toString();

      } // eslint-disable-next-line
      if (jsonx.__functionargs &amp;&amp; jsonx.__functionargs[epropName]) {
        args = [this, ].concat(jsonx.__functionargs[epropName].reduce(boundArgsReducer.call(this, jsonx), []));
      } else if (jsonx.__functionparams===false) {
        args = [this, ];
      } else {
        const functionDefArgs = getParamNames(functionDefinition);
        args = [this, ].concat(functionDefArgs.reduce(boundArgsReducer.call(this, jsonx), []));
      }
      // eslint-disable-next-line
      evVal = functionDefinition.bind(...args);
    } catch (e) { 
      if (this.debug || jsonx.debug) evVal = e;
    }
    // eslint-disable-next-line
    eprops[ epropName ] = evVal;
    if (this.exposeEval) eprops[ `__eval_${epropName}` ] = evValString;
    return eprops;
  }, {});

  return Object.assign({}, evProps, evBindProps, evAllProps);
}

/**
 * Resolves jsonx.__dangerouslyInsertComponents into an object that turns each value into a React components. This is typically used in a library like Recharts where you pass custom components for chart ticks or plot points. 
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @param {Object} [options.resources={}] - object to use for resourceprops(asyncprops), usually a result of an asynchronous call
 * @returns {Object} resolved object of React Components
 */
export function getComponentProps(options = {}) {
  const { jsonx, resources, } = options;
  return Object.keys(jsonx.__dangerouslyInsertComponents).reduce((cprops, cpropName) =&gt; {
    let componentVal;
    try {
      // eslint-disable-next-line
      componentVal = getRenderedJSON.call(this, jsonx.__dangerouslyInsertComponents[ cpropName ], resources);
    } catch (e) {
      if (this.debug || jsonx.debug) componentVal = e;
    }
    cprops[ cpropName ] = componentVal;
    return cprops;
  }, {});
}

export function getReactComponents(options) {
  const { jsonx, resources, } = options;
  const functionComponents = (!jsonx.__dangerouslyInsertFunctionComponents)
    ? {}
    : Object.keys(jsonx.__dangerouslyInsertFunctionComponents).reduce((cprops, cpropName) =&gt; {
      let componentVal;
      try {
        const args = jsonx.__dangerouslyInsertFunctionComponents[ cpropName ];
        args.options = Object.assign({}, args.options, { resources });
        // eslint-disable-next-line
        componentVal = getReactFunctionComponent.call(this, args.reactComponent, args.functionBody, args.options);
      } catch (e) {
        if (this.debug || jsonx.debug) componentVal = e;
      }
      cprops[ cpropName ] = cpropName === &apos;_children&apos; ? [ componentVal ] : componentVal;
      return cprops;
    }, {});
  const classComponents = (!jsonx.__dangerouslyInsertClassComponents)
    ? {}
    : Object.keys(jsonx.__dangerouslyInsertClassComponents).reduce((cprops, cpropName) =&gt; {
      let componentVal;
      try {
        const args = jsonx.__dangerouslyInsertClassComponents[ cpropName ];
        args.options = Object.assign({}, args.options, { resources });
        // eslint-disable-next-line
        componentVal = getReactFunctionComponent.call(this, args.reactComponent, args.options);
      } catch (e) {
        if (this.debug || jsonx.debug) componentVal = e;
      }
      cprops[ cpropName ] = cpropName === &apos;_children&apos; ? [ componentVal ] : componentVal;
      return cprops;
    }, {});
  return Object.assign({}, functionComponents, classComponents);
}

/**
 * Resolves jsonx.__dangerouslyInsertReactComponents into an object that turns each value into a React components. This is typically used in a library like Recharts where you pass custom components for chart ticks or plot points. 
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
//  * @param {Object} [options.resources={}] - object to use for asyncprops, usually a result of an asynchronous call
 * @returns {Object} resolved object of React Components
 */
export function getReactComponentProps(options = {}) {
  const { jsonx, } = options;
  if (jsonx.__dangerouslyInsertJSONXComponents &amp;&amp; Object.keys(jsonx.__dangerouslyInsertJSONXComponents).length) { 
    return Object.keys(jsonx.__dangerouslyInsertJSONXComponents).reduce((cprops, cpropName) =&gt; {
      let componentVal;
      try {
        componentVal = getComponentFromMap({
          jsonx: jsonx.__dangerouslyInsertJSONXComponents[ cpropName ],
          reactComponents: this.reactComponents,
          componentLibraries: this.componentLibraries,
        });
      } catch (e) {
        if (this.debug || jsonx.debug) componentVal = e;
      }
      // eslint-disable-next-line
      cprops[ cpropName ] = componentVal;
      return cprops;
    }, {});
  } else {
    return Object.keys(jsonx.__dangerouslyInsertReactComponents).reduce((cprops, cpropName) =&gt; {
      let componentVal;
      try {
        componentVal = getComponentFromMap({
          jsonx: {
            component: jsonx.__dangerouslyInsertReactComponents[ cpropName ],
            props: jsonx.__dangerouslyInsertComponentProps
              ? jsonx.__dangerouslyInsertComponentProps[ cpropName ]
              : {},
          },
          reactComponents: this.reactComponents,
          componentLibraries: this.componentLibraries,
        });
      } catch (e) {
        if (this.debug || jsonx.debug) componentVal = e;
      }
      // eslint-disable-next-line
      cprops[ cpropName ] = componentVal;
      return cprops;
    }, {});
  }
}

/**
 * Takes a function string and returns a function on either this.props or window. The function can only be 2 levels deep
 * @param {Object} options 
 * @param {String} [options.propFunc=&apos;func:&apos;] - function string, like func:window.LocalStorage.getItem or func:this.props.onClick  or func:inline.myInlineFunction
 * @param {Object} [options.allProps={}] - merged computed props, Object.assign({ key: renderIndex, }, thisprops, jsonx.props, resourceprops, asyncprops, windowprops, evalProps, insertedComponents);
 * @returns {Function} returns a function from this.props or window functions
 * @example
 * getFunctionFromProps({ propFunc=&apos;func:this.props.onClick&apos;, }) // =&gt; this.props.onClick
 */
export function getFunctionFromProps(options) {
  const { propFunc=&apos;func:&apos;, propBody, jsonx, functionProperty=&apos;&apos;, } = options;
  // eslint-disable-next-line
  const { logError = console.error,  debug, } = this;
  const windowObject = this.window || global.window || {};
  try {
    const functionNameString = propFunc.split(&apos;:&apos;)[ 1 ] || &apos;&apos;;
    const functionNameArray = functionNameString.split(&apos;.&apos;);
    const functionName = (functionNameArray.length) ? functionNameArray[ functionNameArray.length - 1 ] : &apos;&apos;;

    if (propFunc.includes(&apos;func:inline&apos;)) {
      // eslint-disable-next-line
      let InlineFunction;
      if (jsonx.__functionargs) {
        const args = [].concat(jsonx.__functionargs[functionProperty]);
        args.push(propBody);
        InlineFunction = Function.prototype.constructor.apply({}, args);
      } else {
        InlineFunction = Function(&apos;param1&apos;, &apos;param2&apos;, &apos;&quot;use strict&quot;;&apos; + propBody);
      }
      const [propFuncName, funcName, ] = propFunc.split(&apos;.&apos;);
      
      Object.defineProperty(
        InlineFunction,
        &apos;name&apos;,
        {
          value: funcName,
        }
      );
      if (jsonx.__functionargs) {
        const boundArgs = [this,].concat(jsonx.__functionargs[functionProperty].map(arg =&gt; jsonx.props[ arg ]));
        return InlineFunction.bind(...boundArgs);
      } else {
        return InlineFunction.bind(this);
      }
    } else if (propFunc.indexOf(&apos;func:window&apos;) !== -1) {
      if (functionNameArray.length === 3) {
        try {
          return windowObject[ functionNameArray[ 1 ] ][ functionName ].bind(this);
        } catch (e) {
          if (debug) {
            logError(e);
          }
          return windowObject[ functionNameArray[ 1 ] ][ functionName ];
        }
      } else {
        try {
          return windowObject[ functionName ].bind(this);
        } catch (e) {
          if (debug) {
            logError(e);
          }
          return windowObject[ functionName ];
        }
      }
    } else if (functionNameArray.length === 4) {
      return (this.props)
        ? this.props[ functionNameArray[ 2 ] ][ functionName ]
        : jsonx.props[ functionNameArray[ 2 ] ][ functionName ];
    } else if (functionNameArray.length === 3) {
      return (this.props)
        ? this.props[ functionName ].bind(this)
        : jsonx.props[ functionName ].bind(this);
    } else {
      return function () {};
    }
  } catch (e) {
    if (this.debug){
      logError(e);
      if (jsonx &amp;&amp; jsonx.debug) return e;
    }
    return function () {};
  }
}

/**
 * Returns a resolved object from function strings that has functions pulled from jsonx.__functionProps
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @param {Object} [options.allProps={}] - merged computed props, Object.assign({ key: renderIndex, }, thisprops, jsonx.props, asyncprops, windowprops, evalProps, insertedComponents);
 * @returns {Object} resolved object of functions from function strings
 */
export function getFunctionProps(options = {}) {
  const { allProps = {}, jsonx = {}, } = options;
  const getFunction = getFunctionFromProps.bind(this);
  const funcProps = jsonx.__functionProps;
  //Allowing for window functions
  Object.keys(funcProps).forEach(key =&gt; {
    if (typeof funcProps[ key ] === &apos;string&apos; &amp;&amp; funcProps[ key ].indexOf(&apos;func:&apos;) !== -1) {
      allProps[ key ] = getFunction({
        propFunc: funcProps[ key ],
        propBody: (jsonx.__inline)?jsonx.__inline[ key ]:&apos;&apos;,
        jsonx,
        functionProperty:key,
      });
    } 
  });
  return allProps;
}

/**
 * Returns a resolved object that has React Components pulled from window.__jsonx_custom_elements
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @param {Object} [options.allProps={}] - merged computed props, Object.assign({ key: renderIndex, }, thisprops, jsonx.props, asyncprops, windowprops, evalProps, insertedComponents);
 * @returns {Object} resolved object of with React Components from a window property window.__jsonx_custom_elements
 */
export function getWindowComponents(options = {}) {
  const { allProps, jsonx, } = options;
  const windowComponents = jsonx.__windowComponents;
  const window = this.window || global.window || {};
  const windowFuncPrefix = &apos;func:window.__jsonx_custom_elements&apos;;
  // if (jsonx.hasWindowComponent &amp;&amp; window.__jsonx_custom_elements) {
  Object.keys(windowComponents).forEach(key =&gt; {
    const windowKEY = (typeof windowComponents[ key ] === &apos;string&apos;)
      ? windowComponents[ key ].replace(`${windowFuncPrefix}.`, &apos;&apos;)
      : &apos;&apos;;
    if (typeof windowComponents[ key ] === &apos;string&apos; &amp;&amp; windowComponents[ key ].indexOf(windowFuncPrefix) !== -1 &amp;&amp; typeof window.__jsonx_custom_elements[ windowKEY ] === &apos;function&apos;) {
      const windowComponentElement = window.__jsonx_custom_elements[ windowKEY ];
      const windowComponentProps = (allProps[ &apos;__windowComponentProps&apos; ]) ? allProps[ &apos;__windowComponentProps&apos; ]
        : this.props;
      allProps[ key ] = React.createElement(
        windowComponentElement,
        windowComponentProps,
        null);
    }
  });
  return allProps;
}

/**
 * Returns computed properties for React Components and any property that&apos;s prefixed with __ is a computedProperty
 * @param {Object} options 
 * @param {Object} options.jsonx - Valid JSONX JSON 
 * @param {Object} [options.resources={}] - object to use for asyncprops, usually a result of an asynchronous call
 * @param {Number} options.renderIndex - number used for React key prop
 * @param {function} [options.logError=console.error] - error logging function
 * @param {Object} [options.componentLibraries] - react components to render with JSONX
 * @param {Boolean} [options.useReduxState=true] - use redux props in this.props
 * @param {Boolean} [options.ignoreReduxPropsInComponentLibraries=true] - ignore redux props in this.props for component libraries, this is helpful incase these properties collide with component library element properties
 * @param {boolean} [options.debug=false] - use debug messages
 * @example
const testJSONX = { component: &apos;div&apos;,
  props: { id: &apos;generatedJSONX&apos;, className: &apos;jsonx&apos; },
  children: [ [Object] ],
  asyncprops: { auth: [Array], username: [Array] },
  __dangerouslyEvalProps: { getUsername: &apos;(user={})=&gt;user.name&apos; },
  __dangerouslyInsertComponents: { myComponent: [Object] } 
const resources = {
  user: {
    name: &apos;jsonx&apos;,
    description: &apos;react withouth javascript&apos;,
  },
  stats: {
    logins: 102,
    comments: 3,
  },
  authentication: &apos;OAuth2&apos;,
};
const renderIndex = 1;
getComputedProps.call({}, {
        jsonx: testJSONX,
        resources,
        renderIndex,
      });
computedProps = { key: 1,
     id: &apos;generatedJSONX&apos;,
     className: &apos;jsonx&apos;,
     auth: &apos;OAuth2&apos;,
     username: &apos;jsonx&apos;,
     getUsername: [Function],
     myComponent:
      { &apos;$$typeof&apos;: Symbol(react.element),
        type: &apos;p&apos;,
        key: &apos;8&apos;,
        ref: null,
        props: [Object],
        _owner: null,
        _store: {} } } }
 *
 */
export function getComputedProps(options = {}) {
  // eslint-disable-next-line
  const { jsonx = {}, resources = {}, renderIndex, logError = console.error, useReduxState=true, ignoreReduxPropsInComponentLibraries=true, disableRenderIndexKey=true, componentLibraries, debug, } = options;
  try {
    const componentThisProp = (jsonx.thisprops)
      ? Object.assign({
        __jsonx: {
          _component: jsonx,
          _resources: resources,
        },
      }, this.props,
      jsonx.props,
      (useReduxState &amp;&amp; !jsonx.ignoreReduxProps &amp;&amp; (ignoreReduxPropsInComponentLibraries &amp;&amp; !componentLibraries[ jsonx.component ]))
        ? (this.props &amp;&amp; this.props.getState) ? this.props.getState() : {}
        : {}
      )
      : undefined;
    const windowTraverse = typeof window !== &apos;undefined&apos; ? window : {};
    const asyncprops = jsonx.asyncprops ? getJSONXProps({ jsonx, propName: &apos;asyncprops&apos;, traverseObject: resources, }) : {};
    const resourceprops = jsonx.resourceprops ? getJSONXProps({ jsonx, propName: &apos;resourceprops&apos;, traverseObject: resources, }) : {};
    const windowprops = jsonx.windowprops ? getJSONXProps({ jsonx, propName: &apos;windowprops&apos;, traverseObject: windowTraverse, }) : {};
    const thisprops = jsonx.thisprops ? getJSONXProps({ jsonx, propName: &apos;thisprops&apos;, traverseObject: componentThisProp, }) : {};
    const thisstate = jsonx.thisstate ? getJSONXProps({ jsonx, propName: &apos;thisstate&apos;, traverseObject: this.state, }) : {};

    //allowing javascript injections
    const evalProps = (jsonx.__dangerouslyEvalProps || jsonx.__dangerouslyBindEvalProps)
      ? getEvalProps.call(this, { jsonx, })
      : {};
    const insertedComponents = (jsonx.__dangerouslyInsertComponents)
      ? getComponentProps.call(this, { jsonx, resources, debug, })
      : {};
    const insertedReactComponents = (jsonx.__dangerouslyInsertReactComponents || jsonx.__dangerouslyInsertJSONXComponents)
      ? getReactComponentProps.call(this, { jsonx, debug, })
      : {};
    const insertedComputedComponents = (jsonx.__dangerouslyInsertFunctionComponents  || jsonx.__dangerouslyInsertClassComponents)
      ? getReactComponents.call(this, { jsonx, debug, })
      : {};
    
    const evalAllProps = (jsonx.__dangerouslyEvalAllProps)
      ? getEvalProps.call(this, { jsonx, })
      : {};
    const allProps = Object.assign({}, this.disableRenderIndexKey || disableRenderIndexKey ? {}: { key: renderIndex, }, jsonx.props, thisprops, thisstate, resourceprops, asyncprops, windowprops, evalProps, insertedComponents, insertedReactComponents, insertedComputedComponents);
    const computedProps = Object.assign({}, allProps,
      jsonx.__functionProps ? getFunctionProps.call(this, { allProps, jsonx, }) : {},
      jsonx.__windowComponents ? getWindowComponents.call(this, { allProps, jsonx, }) : {},
      jsonx.__spreadComponent ? getChildrenComponents.call(this, { allProps, jsonx, }) : {},
      evalAllProps);
    if (jsonx.debug) console.debug({ jsonx, computedProps, });
    return computedProps;
  } catch (e) {
    debug &amp;&amp; logError(e, (e.stack) ? e.stack : &apos;no stack&apos;);
    return null;
  }
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>


</body></html>
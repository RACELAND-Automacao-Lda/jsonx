<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>JSONX TEST</title>
    <!-- <script type="text/javascript" src="jsonx.web.js"></script> -->
    <script type="text/javascript" src="../../dist/index.web.min.js"></script>
    <script type="text/javascript">
    window.React = jsonx.__getReact();
    window.ReactDOM = jsonx.__getReactDOM();
    // shallowEqual=()=>{};
    // console.log({jsonx});
    // console.log({React});
    </script>

  </head>
  <body>
    <div id="root"></div>
    <script type="text/javascript">
      function IntroHook(){
        const [count, setCount] = useState(0);

        useEffect(()=>{
          console.log('only run once')
        },[])
        const exposeprops = {count,setCount,extraVal:'some extra value'};
        return {
          component:'div',
          props:{
            extra:'ok'
          },
          passprops:true,
          children:[
            {
              component:'p',
              children: 'This is from IntroHookComponent '
            },
            {
                component:'p',
                passprops:true,
                children:[
                  {
                    component:'span',
                    __dangerouslyEvalAllProps:function(){
                      return { 
                        style:{color:'red'}
                       }
                    },
                    children:'You clicked ',
                  },
                  {
                    component:'input',
                    props:{
                      name:'inputCount',
                      defaultValue:0
                    },
                    thisprops:{
                      value:['count'],
                    },
                  },
                  {
                    component:'span',
                    children:' times'
                  }
                ]
            },
            {
              component:'button',
              props:{
                id:'buttonCount'
              },
              __dangerouslyBindEvalProps:{
                onClick(count,setCount){
                  setCount(count+1);
                },
              },
              children:'Click me'
            }
          ],
        }
      }
      const IntroHookComponent = jsonx._jsonxComponents.makeFunctionComponent(IntroHook)

      const sampleJSONX = {
        component: 'div',
        props: {
          id: 'generatedJSONX',
          className:'jsonx',
          otherProp: 'testing Other Prop',
          style:{
            padding:'1rem',
          }
        },
        children: [
          {
            component:'IntroHookComponent',
            props:{
              status:'custom status prop',
            },
            resourceprops:{
              punc:['punc']
            }
          },
        ],
      };
      const boundConfig = {
        debug:true, 
        reactComponents:{
          IntroHookComponent,
        },
        componentLibraries:{
          // Spectre,
        }
      };
      // console.log({boundConfig})
      jsonx.jsonxRender.call(boundConfig,{ 
        jsonx: sampleJSONX, 
        resources: { 
          addedStatus:'LIVE',
          punc:'TEST RESOURCE!!'
        },
        querySelector:'#root', });
    </script>
  </body>
</html>